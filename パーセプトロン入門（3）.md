# パーセプトロン入門（3）

### 1. 学習機能とは？

パーセプトロンは、複数の入力に対して重みを設定し、計算結果によって分類を行うシンプルな機械学習モデルです。しかし、これまでのパーセプトロンは、重みを手動で設定していました。

現実の問題では、「最適な重み」を自動で見つけることが重要です。そこで、学習機能を追加し、パーセプトロンがデータをもとに「適切な重み」を調整できるようにすることで、未知のデータに対しても適切に分類できるようになります。

この章では、学習機能を持つパーセプトロンの仕組みと、Pythonを使った具体的な実装方法を学んでいきましょう。

---

### 2. 学習の流れ

パーセプトロンの学習プロセスは、以下の4つのステップで進みます。

1. **入力データと正解ラベルを用意する**
   - 例: 「国語80点、数学50点、英語90点 → 合格（OK）」
2. **現在の重みで予測し、誤差を計算する**
   - 予測スコアが100以上なら「OK」、未満なら「NG」
3. **誤差を元に重みを修正する（学習）**
   - 学習率を考慮しながら、誤差に応じて重みを更新する
4. **このプロセスを繰り返し、最適な重みを見つける**
   - エポック（繰り返し回数）を設定し、収束するまで学習を行う

この流れを繰り返すことで、パーセプトロンはデータに適応し、より正確な予測が可能になります。

---

### 3. Pythonで学習機能を追加する

それでは、実際にPythonで学習機能付きのパーセプトロンを実装してみましょう。

```python
# しきい値の設定（合計スコアがこの値以上ならOKと判定）
threshold = 100  

# 学習データ（入力値, 正解ラベル）
data = [
    ([80, 50, 90], "OK"),  # 合格
    ([30, 20, 40], "NG"),  # 不合格
    ([50, 60, 70], "OK"),  # 合格
    ([40, 30, 20], "NG")   # 不合格
]

# 初期重みの設定
weights = [0.1, 0.1, 0.1]  # 初期値はすべて0.1
learning_rate = 0.01  # 学習率（どの程度修正するか）

def train_perceptron(data, weights, learning_rate, epochs=1000):
    """
    パーセプトロンの学習関数
    """
    for epoch in range(epochs):  # 指定回数繰り返す
        for inputs, label in data:
            # 1.予測
            score = sum(inputs[i] * weights[i] for i in range(len(inputs)))
            prediction = "OK" if score >= threshold else "NG"  
            
            # 2.誤差の計算
            actual = 1 if label == "OK" else 0
            predicted = 1 if prediction == "OK" else 0
            error = actual - predicted  
            
            # 3.重みの修正
            for i in range(len(weights)):
                weights[i] += learning_rate * error * inputs[i]  
    return weights

# 学習を実行
trained_weights = train_perceptron(data, weights, learning_rate)

# 学習後の結果を出力
print("学習後の重み:", trained_weights)
```

### 4. 実行結果と分析

#### 学習後の重み
```
学習後の重み: [0.9, 0.6, 1.0]
```

#### 学習後の予測結果

| 入力データ (国語, 数学, 英語) | 計算されたスコア | 予測結果 |
|--------------------|--------------|----------|
| [80, 50, 90] | 192.0 | OK |
| [30, 20, 40] | 79.0 | NG |
| [50, 60, 70] | 151.0 | OK |
| [40, 30, 20] | 74.0 | NG |

この結果から、学習前に与えたデータ通りに適切な重みが学習され、正しい分類ができるようになったことがわかります。

---

### 5. まとめ

- **学習機能を追加することで、最適な重みを自動で見つけられるようになる**
- **誤差を元に重みを修正することで、正しい判定を学習できる**
- **データが増えるほど、より精度の高い判定が可能になる**
- **この基礎を理解することで、より高度な機械学習モデルの学習へつなげることができる**
